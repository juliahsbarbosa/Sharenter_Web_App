<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5">
<head>
    <!--Required Meta tags-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link th:href="@{/img/favicon.png}" rel="icon">

    <!--Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

    <!-- Custom CSS Stylesheet -->
    <link th:href="@{/css/style.css}" rel="stylesheet"/>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>


    <script type="module" th:src="@{/js/index.js}"></script>

    <title> Sharer - Dashboard </title>


</head>
<body>


<!--Header Fragment-->
<header th:replace="fragments/header.html :: header"></header>

<main>

    <div class="container">
        <h1 class="text-center">Sharer Dashboard</h1>
        <h4 class="text-center my-3" th:text="'Welcome back ' + ${currentEmail} + '!'"></h4>


        <div class="row mt-5">
            <div class="col">
                <h2 class="text-center py-3">My Listings</h2>

                <!--Page sorting-->
                <div class="row sorting d-flex justify-content-start">
                    <div class="col">
                        <p class="fw-bold">Sort by:</p>
                    </div>
                    <div class="col">
                        <a th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty='
                        + searchedCounty + '&' : ''} + 'page=' + ${currentPage} + '&size=' + ${pageSize} + '&sortField=creationDate' +
                        '&sortBy=' + ${reverseSortBy}}">Creation Date<img th:src="@{/img/sort.png}" aria-label="logo"
                                                                          alt="sort"></a>
                    </div>
                    <div class="col">
                        <a th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty='
                        + searchedCounty + '&' : ''} + 'page=' + ${currentPage} + '&size=' + ${pageSize} + '&sortField=rent'
                        +'&sortBy=' + ${reverseSortBy }}">Rent<img th:src="@{/img/sort.png}" aria-label="logo"
                                                                   alt="sort"></a>
                    </div>
                </div><!--End row sorting-->


                <!-- Card -->
                <div class="card my-3 sharer-dash rounded" th:each="listings : ${listingsByUser}">
                    <div class="row">

                        <!--Room Image-->
                        <div class="col-md-12">
                            <img class="img-index" th:src="${listings.imageUrl}">
                        </div>

                        <div class="col-md-12">
                            <div class="card-body">
                                <!--Listing title-->
                                <h5 class="card-title text-center" th:text="${listings.title}"></h5>

                                <!--Listing rent price-->
                                <p class="my-0 py-0 text-sm-start">
                                    <span class="card-text bold">Rent: </span>
                                    <span class="card-text" th:text="${listings.rent}"></span>
                                </p>

                                <!--Listing address-->
                                <p class="my-0 py-0 text-sm-start">
                                    <span class="card-text bold">Address:</span>
                                    <span class="card-text" th:text="${listings.address}"></span>
                                </p>


                                <!--Listing room type-->
                                <!--Displays if the bathroom is private or not-->
                                <p class="my-0 py-0 text-sm-start">
                                    <img class="pr-1" th:src="@{/img/bed.png}" alt="bed"><span class="card-text"
                                                                                               th:text="${listings.roomType}"></span><span> Room</span>
                                    <img class="pl-5" th:src="@{/img/bathroom.png}" alt="bathroom">
                                    <span class="card-text"
                                          th:if="${listings.privateBathroom == true }">Private Bathroom</span>
                                    <span class="card-text"
                                          th:unless="${listings.privateBathroom == true}">Shared Bathroom</span>
                                </p>

                                <p>
                                    <span class="card-text">Created by:</span>
                                    <span class="card-text" th:text="${listings.createdBy}"></span>
                                </p>
                                <p>
                                    <span class="card-text">Created on:</span>
                                    <span class="card-text" th:text="${listings.creationDate}"></span>
                                </p>
                                <!--              <a th:href="@{/renter/listing-details/{id}(id=${listings.id})}"-->
                                <!--                     class="btn">Details</a>-->
                                <div class="d-flex justify-content-end">
                                    <a th:href="@{/sharer/edit-listing/{id}(id=${listings.id})}">
                                        <button class="btn rounded-pill mx-3" type="button">Update</button>
                                    </a>
                                    <a th:href="@{/sharer/delete-listing/{id}(id=${listings.id})}">
                                        <button class="btn rounded-pill mx-3 btn-blue" type="button">Delete</button>
                                    </a>
                                </div>
                            </div><!--End card-body-->
                        </div><!--End col-->
                    </div><!--End row-->
                </div><!--End card-->

                <!--Pagination-->
                <nav aria-label="Pagination" th:if="${totalPages > 1}" class="mt-3">
                    <ul class="pagination">
                        <li class="page-item">
                            <a class="page-link"
                               th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}
                           + 'page=1' + '&size=' + ${pageSize}
                           + ${sortField!=null ? '&sort=' + sortField + ',' + sortBy : ''}}">
                                <<
                            </a>
                        </li>
                        <li class="page-item font-weight-bold"
                            th:classappend="${currentPage == 1} ? 'disabled'">
                            <a class="page-link"
                               th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}
                           + 'page=' + ${currentPage - 1} + '&size=' + ${pageSize}
                           + ${sortField!=null ? '&sort=' + sortField + ',' + sortBy : ''}}">
                                Previous
                            </a>
                        </li>
                        <li class="page-item disabled" th:if="${currentPage - 2 > 1}">
                            <a class="page-link" href="#">...</a>
                        </li>
                        <li class="page-item" th:classappend="${page == currentPage} ? 'active'"
                            th:each="page : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 1, currentPage + 2 < totalPages ? currentPage + 2 : totalPages)}">
                            <a class="page-link"
                               th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}
                           + 'page=' + ${page} + '&size=' + ${pageSize}
                           + ${sortField!=null ? '&sort=' + sortField + ',' + sortBy : ''}}">
                                [[${page}]]
                            </a>

                        </li>
                        <li class="page-item disabled" th:if="${currentPage + 2 < totalPages}">
                            <a class="page-link" href="#">...</a>
                        </li>
                        <li class="page-item font-weight-bold"
                            th:classappend="${currentPage == totalPages} ? 'disabled'">
                            <a class="page-link"
                               th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}
                           + 'page=' + ${currentPage + 1} + '&size=' + ${pageSize}
                           + ${sortField!=null ? '&sort=' + sortField + ',' + sortBy : ''}}">
                                Next
                            </a>
                        </li>
                        <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
                            <a class="page-link"
                               th:href="@{'/sharer/dashboard?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}
                           + 'page=' + ${totalPages} + '&size=' + ${pageSize}
                           + ${sortField!=null ? '&sort=' + sortField + ',' + sortBy : ''}}">Last Page</a>
                        </li>
                    </ul>

                </nav><!--End pagination-->
            </div><!--End col-->


            <div class="col">
                <h2 class="text-center py-3">Messages Received</h2>
            </div>

        </div><!--End row -->
    </div><!--End container-->
</main>

<!--Footer Fragment-->
<footer th:replace="fragments/footer.html :: footer"></footer>

</body>
</html>
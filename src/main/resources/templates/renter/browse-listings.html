<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5" xmlns="http://www.w3.org/1999/html">
<head>
    <!--Required Meta tags-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Favicon -->
    <link th:href="@{/img/favicon.png}" rel="icon">
    <i class="fa-solid fa-house"></i>

    <!--Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">

    <!-- Bootstrap Font Icon CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.2/font/bootstrap-icons.css">


    <script crossorigin="anonymous" src="https://kit.fontawesome.com/9dfa6c6e5c.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
            src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
            src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script crossorigin="anonymous"
            integrity="sha384-b5kHyXgcpbZJO/tY9Ul7kGkf1S0CWuKcCD38l8YkeH8z8QjE0GmW1gYU5S9FOnJ0"
            src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.1.1.min.js"></script>
    <!--    <script th:src="@{/markerclusterer.js}"></script>-->
    <script th:src="@{/js/index.js}" type="javascript"></script>


    <!--    <script th:src="@{/maps-common.js}" type="text/javascript"></script>-->

    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

    <!--    <script type="text/javascript" th:src="@{https://maps.googleapis.com/maps/api/js(callback=initMap, key=mapsApiKey)}"></script>-->


    <!-- Custom CSS Stylesheet -->
    <link th:href="@{/css/style.css}" rel="stylesheet"/>

    <title> Renter - Browse Listings </title>

</head>
<body>

<!--Header Fragment-->
<header th:replace="fragments/header.html :: header"></header>

<div class="container d-flex mt-50 mb-50">

</div>

<!--Listings-->
<div class="container">
    <h1 class="text-center">Browse listings</h1>


    <!--Page sorting and filtering-->
    <table class="table table-striped table-responsive-md">
        <thead>
        <tr>
<!--            <th>-->
<!--                <a th:href="@{'/renter/browse-listings?'+ ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}-->
<!--                +'page=' ${currentPage} + '?sortField=id&sortDir=' + ${reverseSortBy}}">Id</a>-->
<!--            </th>-->
<!--            <th>-->
<!--                <a th:href="@{'/renter/browse-listings?'+ ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}-->
<!--                +'page=' + ${currentPage} + '?sortField=creationDate&sortBy=' + ${reverseSortBy}}">Creation Date</a>-->
<!--            </th>-->
<!--            <th>-->
<!--                <a th:href="@{'/renter/browse-listings?'+ ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}-->
<!--                +'page=' + ${currentPage} + '?sortField=rent&sortBy=' + ${reverseSortBy}}">Rent</a>-->
<!--            </th>-->
            <th th:replace="fragments/paging :: sorting('id','Id')"></th>
            <th th:replace="fragments/paging :: sorting('rent','Rent')"></th>
            <th th:replace="fragments/paging :: sorting('creationDate','Creation Date')"></th>
        </tr>
        </thead>
    </table>


    <div class="row">
        <div class="col overflow-scroll">
            <div class="card mt-3" style="max-width: 700px;" th:each="listings : ${allListings}">
                <div class="row g-0">
                    <div class="col-md-12">
                        <img class="img-thumbnail" th:src="${listings.imageUrl}">
                        <!--                        <img th:src="@{/img/room-3.jpg}" class="img-fluid" alt="...">-->
                    </div>
                    <div class="col-md-12">
                        <div class="card-body">
                            <h5 class="card-title" th:text="${listings.title}"></h5>
                            <p class="text-small-muted">
                                <span>Ref#: </span>
                                <span th:text="${listings.id}"></span>
                            </p>

                            <p class="mt-3 mb-0 text-sm col-3">
                                <span class="card-text">Rent: <i class="bi bi-currency-euro"></i></span>
                                <span class="card-text" th:text="${listings.rent}"></span>
                            </p>

                            <p>
                                <span class="card-text">Type of room:</span>
                                <span class="card-text" th:text="${listings.roomType}"></span>
                            </p>

                            <!--                            <p>-->
                            <!--                                <span class="card-text">Walksore:</span>-->
                            <!--                                <span class="card-text" th:text="${walkscore.getScore()}"></span>-->
                            <!--                                <span class="card-text" th:text="${walkscore.getDescription()}"></span>-->
                            <!--                            </p>-->

                            <p>
                                <span class="card-text">Number of housemates:</span>
                                <span class="card-text" th:text="${listings.numHousemates}"></span>
                            </p>
                            <p>
                                <span class="card-text"
                                      th:if="${listings.privateBathroom == true }">Private Bathroom</span>
                                <span class="card-text" th:unless="${listings.privateBathroom == true}"></span>
                            </p>

                            <p>
                                <span class="card-text" th:if="${listings.parking == true }">Have Parking</span>
                                <span class="card-text" th:unless="${listings.parking == true}">No Parking</span>
                            </p>


                            <p>
                                <span class="card-text">Created by:</span>
                                <span class="card-text" th:text="${listings.createdBy}"></span>
                            </p>
                            <p>
                                <span class="card-text">Created on:</span>
                                <span class="card-text" th:text="${listings.creationDate}"></span>
                            </p>

                            <p>
                                <!--                                <span class="card-text">Latitude:</span>-->
                                <span hidden id="listingLat" th:data-lat th:text="${listings.lat}"></span>
                            </p>

                            <p>
                                <!--                                <span class="card-text">Longitude:</span>-->
                                <span hidden id="listingLng" th:data-lng th:text="${listings.lng}"></span>
                            </p>

                            <td><a th:href="@{/renter/listing-details/{id}(id=${listings.id})}" class="btn">Details</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="listings-map" class="col overflow-hidden" style="width:300px; height:700px">

        </div>
    </div>
</div>

<!--<nav aria-label="Pagination" th:if="${totalPages > 0}">-->
<!--    <ul class="pagination justify-content-center">-->
<!--        <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">-->
<!--            <a th:replace="fragments/paging :: paging(1, '<<', 'First Page')"></a>-->
<!--        </li>-->
<!--        <li class="page-item font-weight-bold" th:classappend="${currentPage == 1} ? 'disabled'">-->
<!--            <a th:replace="fragments/paging :: paging(${currentPage - 1}, 'Prev', 'Previous Page')"></a>-->
<!--        </li>-->
<!--        <li class="page-item disabled" th:if="${currentPage - 2 > 1}">-->
<!--            <a class="page-link" href="#">...</a>-->
<!--        </li>-->
<!--        <li class="page-item" th:classappend="${page == currentPage} ? 'active'"-->
<!--            th:each="page : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 1, currentPage + 2 < totalPages ? currentPage + 2 : totalPages)}">-->
<!--            <a th:replace="fragments/paging :: paging(${page}, ${page}, 'Page ' + ${page})"></a>-->
<!--        </li>-->
<!--        <li class="page-item disabled" th:if="${currentPage + 2 < totalPages}">-->
<!--            <a class="page-link" href="#">...</a>-->
<!--        </li>-->
<!--        <li class="page-item font-weight-bold" th:classappend="${currentPage == totalPages} ? 'disabled'">-->
<!--            <a th:replace="fragments/paging :: paging(${currentPage + 1},'Next', 'Next Page')"></a>-->
<!--        </li>-->
<!--        <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">-->
<!--            <a th:replace="fragments/paging :: paging(${totalPages}, '>>', 'Last Page')"></a>-->
<!--        </li>-->
<!--    </ul>-->
<!--</nav>-->

<!--<a th:fragment="paging(pageNo, pageLabel, tooltip)" class="page-link" th:href="@{'/renter/browse-listings?'-->
<!--+ ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''} + 'page=' + ${pageNo} + '&size=' + ${pageSize}}"-->
<!--   th:title="${tooltip}" rel="tooltip">-->
<!--    [[${pageLabel}]]-->
<!--</a>-->
<!--<div class="section">-->
<!--    <div class="page-subheader sorting pl0 pr-10">-->
<!--        <div th:if="${totalPages > 1}">-->
<!--            <div class="row col-sm-10">-->
<!--                <div class="col-sm-2">-->
<!--                    Total Rows: [[${totalItems}]]-->
<!--                </div>-->
<!--                <div class="col-sm-1">-->
<!--                    <span th:each="i: ${#numbers.sequence(1, totalPages)}">-->
<!--                        <a class="page-link" th:if="${currentPage != i}"-->
<!--                           th:href="@{'/renter/browse-listings?' + + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}-->
<!--                                +'page=' + ${i} + '?sortField=' + ${sortField} + '&sortBy=' + ${sortBy}}">[[${i}]]</a>-->
<!--                        <span th:unless="${currentPage != i}">[[${i}]]</span>  &nbsp; &nbsp;</span>-->
<!--                </div>-->

<!--                <div class="col-sm-1">-->
<!--                    <a class="page-link" th:if="${currentPage < totalPages}"-->
<!--                       th:href="@{'/renter/browse-listings?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}-->
<!--                       +'page=' + ${currentPage + 1} + '?sortField=' + ${sortField} + '&sortBy=' + ${sortBy}}">Next</a>-->
<!--                    <span th:unless="${currentPage < totalPages}">Next</span>-->
<!--                </div>-->

<!--                <div class="col-sm-1">-->
<!--                    <a th:if="${currentPage < totalPages}"-->
<!--                       th:href="@{'/renter/browse-listings?' + ${searchedCounty!=null && searchedCounty!=''? 'searchedCounty=' + searchedCounty + '&' : ''}-->
<!--                        + ${totalPages}+ '?sortField=' + ${sortField} + '&sortBy=' + ${sortBy}}">Last</a>-->
<!--                    <span th:unless="${currentPage < totalPages}">Last</span>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<nav aria-label="Pagination" th:if = "${totalPages > 1}">-->
<!--    <div class = "row col-sm-10">-->
<!--        <div class = "col-sm-2">-->
<!--            Total Rows: [[${totalItems}]]-->
<!--        </div>-->
<!--        <div class = "col-sm-1">-->
<!--     <span th:each="i: ${#numbers.sequence(1, totalPages)}">-->
<!--      <a th:if="${currentPage != i}" th:href="@{'/page/' + ${i}+ '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">[[${i}]]</a>-->
<!--      <span th:unless="${currentPage != i}">[[${i}]]</span>  &nbsp; &nbsp;-->
<!--     </span>-->
<!--        </div>-->
<!--        <div class = "col-sm-1">-->
<!--            <a th:if="${currentPage < totalPages}" th:href="@{'/page/' + ${currentPage + 1}+ '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">Next</a>-->
<!--            <span th:unless="${currentPage < totalPages}">Next</span>-->
<!--        </div>-->

<!--        <div class="col-sm-1">-->
<!--            <a th:if="${currentPage < totalPages}" th:href="@{'/page/' + ${totalPages}+ '?sortField=' + ${sortField} + '&sortDir=' + ${sortDir}}">Last</a>-->
<!--            <span th:unless="${currentPage < totalPages}">Last</span>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->





<nav aria-label="Pagination" th:if="${totalPages > 0}">
    <ul class="pagination justify-content-center">
        <li class="page-item" th:classappend="${currentPage == 1} ? 'disabled'">
            <a th:replace="fragments/paging :: paging(1, '<<', 'First Page')"></a>
        </li>
        <li class="page-item font-weight-bold" th:classappend="${currentPage == 1} ? 'disabled'">
            <a th:replace="fragments/paging :: paging(${currentPage - 1}, 'Prev', 'Previous Page')"></a>
        </li>
        <li class="page-item disabled" th:if="${currentPage - 2 > 1}">
            <a class="page-link" href="#">...</a>
        </li>
        <li class="page-item" th:classappend="${page == currentPage} ? 'active'"
            th:each="page : ${#numbers.sequence(currentPage > 2 ? currentPage - 2 : 1, currentPage + 2 < totalPages ? currentPage + 2 : totalPages)}">
            <a th:replace="fragments/paging :: paging(${page}, ${page}, 'Page ' + ${page})"></a>
        </li>
        <li class="page-item disabled" th:if="${currentPage + 2 < totalPages}">
            <a class="page-link" href="#">...</a>
        </li>
        <li class="page-item font-weight-bold" th:classappend="${currentPage == totalPages} ? 'disabled'">
            <a th:replace="fragments/paging :: paging(${currentPage + 1},'Next', 'Next Page')"></a>
        </li>
        <li class="page-item" th:classappend="${currentPage == totalPages} ? 'disabled'">
            <a th:replace="fragments/paging :: paging(${totalPages}, '>>', 'Last Page')"></a>
        </li>
    </ul>
</nav>


<!--Footer Fragment-->
<footer th:replace="fragments/footer.html :: footer"></footer>


<!--<script th:inline="jascript">-->
<!--    var map;-->
<!--    var parkLats = $("#listingLat").attr('name');-->
<!--    var parkLngs = $("#listingLng").attr('name');-->
<!--    // lat = parseFloat(parkLats);-->
<!--    // lng = parseFloat(parkLngs);-->

<!--    for(var i = 0; i < parkLats.length; i++) {-->
<!--        parkLats[i] = parseFloat(parkLats[i])-->
<!--        parkLngs[i] = parseFloat(parkLngs[i])-->
<!--    }-->

<!--    function initMap() {-->
<!--        map = new google.maps.Map(document.getElementById('map'), {-->
<!--            center: {lat: lat, lng: lng},-->
<!--            zoom: 14-->
<!--        });-->

<!--        var cityCircle = new google.maps.Circle({-->
<!--            strokeColor: '#FF0000',-->
<!--            strokeOpacity: 0.8,-->
<!--            strokeWeight: 2,-->
<!--            fillColor: '#FF0000',-->
<!--            fillOpacity: 0.35,-->
<!--            map: map,-->
<!--            center: {lat: lat, lng: lng},-->
<!--            radius: 40-->
<!--        });-->

<!--        var markers = []-->
<!--        markers.length = parkLats.length-->
<!--        for(var i = 0; i < parkLats.length; i++) {-->

<!--            markers[i] = new google.maps.Marker({-->
<!--                map: map,-->
<!--                position: {lat: parkLats[i], lng: parkLngs[i]}-->
<!--            });-->

<!--        }-->
<!--    }-->
<!--</script>-->

<!--Bootstrap Bundle (JavaScript and Popper)-->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3"
        crossorigin="anonymous"></script>

<script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>

<script th:src="@{/js/index.js}" type="text/javascript"></script>

<script th:src="@{'https://maps.googleapis.com/maps/api/js?key=' + ${mapsApiKey} + '&amp;callback=initMap&amp;v=weekly'}"></script>
</body>
</html>